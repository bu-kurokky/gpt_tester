const _0x23bf75=_0xe105;(function(_0x21a071,_0x52fc73){const _0x6bb1d1=_0xe105,_0xa2ce27=_0x21a071();while(!![]){try{const _0x13e443=-parseInt(_0x6bb1d1(0x123))/0x1*(-parseInt(_0x6bb1d1(0xeb))/0x2)+-parseInt(_0x6bb1d1(0x113))/0x3+parseInt(_0x6bb1d1(0x148))/0x4*(-parseInt(_0x6bb1d1(0x103))/0x5)+-parseInt(_0x6bb1d1(0x105))/0x6+parseInt(_0x6bb1d1(0xf0))/0x7*(parseInt(_0x6bb1d1(0x13e))/0x8)+-parseInt(_0x6bb1d1(0x122))/0x9+parseInt(_0x6bb1d1(0x14a))/0xa;if(_0x13e443===_0x52fc73)break;else _0xa2ce27['push'](_0xa2ce27['shift']());}catch(_0x15876f){_0xa2ce27['push'](_0xa2ce27['shift']());}}}(_0x3276,0xe047f));let messageHistory=[],logHistory=[],promptTime=![],textarea,clientHeight,modelType=_0x23bf75(0xff);const formMax=window[_0x23bf75(0x146)]*0.01*0x19;function _0xe105(_0x394861,_0x57e07e){const _0x327606=_0x3276();return _0xe105=function(_0xe1057d,_0x5c219e){_0xe1057d=_0xe1057d-0xdc;let _0xd46c1=_0x327606[_0xe1057d];return _0xd46c1;},_0xe105(_0x394861,_0x57e07e);}window[_0x23bf75(0x11f)](_0x23bf75(0xe8),function(){const _0x161b42=_0x23bf75;checkKey(),getHistory(),textarea=document[_0x161b42(0x112)]('textarea'),textarea[_0x161b42(0x11f)](_0x161b42(0x124),textAreaSize,![]),textarea[_0x161b42(0x11f)](_0x161b42(0x136),chatSend,![]),clientHeight=textarea[_0x161b42(0x147)],document[_0x161b42(0x112)](_0x161b42(0xfe))[_0x161b42(0x11f)](_0x161b42(0xf3),download,![]),document[_0x161b42(0x112)](_0x161b42(0x14c))[_0x161b42(0x11f)](_0x161b42(0xf3),sendPrompt,![]),document[_0x161b42(0x112)](_0x161b42(0x10f))['addEventListener'](_0x161b42(0xf3),saveKey,![]),document['getElementById'](_0x161b42(0x107))[_0x161b42(0x11f)]('click',newQuestion,![]),document[_0x161b42(0x112)](_0x161b42(0x14f))[_0x161b42(0x11f)](_0x161b42(0xf3),removeHistory,![]);const _0x2ec67b=document['querySelectorAll'](_0x161b42(0x130));if(!_0x2ec67b)return![];_0x2ec67b['forEach'](_0x69802f=>{const _0x56d65f=_0x161b42;_0x69802f[_0x56d65f(0x11f)](_0x56d65f(0xf3),clickHistory,![]);});});function checkModel(){const _0x542ae0=_0x23bf75,_0x2b3703=document['getElementById'](_0x542ae0(0x115))['selectedIndex'];modelType=document[_0x542ae0(0x112)](_0x542ae0(0x115))[_0x2b3703][_0x542ae0(0xe4)];}function clickHistory(_0x480e58=![]){const _0x516b43=_0x23bf75;let _0x2d2d67;_0x480e58[_0x516b43(0x13c)]?_0x2d2d67=_0x480e58['getAttribute'](_0x516b43(0xdc)):_0x2d2d67=this[_0x516b43(0xf2)]('time');const _0x204e6d=localStorage[_0x516b43(0x14b)]('histories');nowHistory=JSON[_0x516b43(0x135)](_0x204e6d),nowHistory[_0x516b43(0xfd)](_0x347d95=>{const _0xde1240=_0x516b43;_0x347d95[_0xde1240(0xdc)]==_0x2d2d67&&(promptTime=_0x2d2d67,messageHistory=_0x347d95[_0xde1240(0xe0)],switchHistory());});}function _0x3276(){const _0x2352eb=['content','data','&#x60;','setAttribute','getMinutes','value','body','myKey','&gt;','load','<p><span\x20class=\x22question\x22>Q</span></p>','key','956156LtbrgD','length','getSeconds','href','data:','7fDnyDm','choices','getAttribute','click','https://api.openai.com/v1/chat/completions','application/json','slice','POST','</article>','api_key','textarea','append','string','forEach','download','gpt-3.5-turbo','querySelector','preventDefault','scrollTop','37855emnqFC','&amp;','6085926aBrLbC','assistant','new_question','height','firstElementChild','reverse','metaKey','getHours','blur','#chat_log\x20li','save_key','setItem','chat_log','getElementById','1473840cDkECs','user','model','ctrlKey','replace','add','join','stringify','prepend','.md','indexOf','#chat_log\x20li:last-of-type\x20article','addEventListener','error','split','2437992hujURW','1rKeYAs','input','#1\x20','querySelectorAll','warning','createElement','history','chatgpt_log_','h_log','Enter','[DONE]','style','Error:','.h_log','histories','onclick','startsWith','decode','parse','keydown','text/plain','appendChild','<article>','&quot;','remove','innerHTML','delta','8180232ydqBCW','<p><span\x20class=\x22answer\x22>A</span></p>','title','&lt;','read','log','innerText','&#x27;','innerHeight','clientHeight','548yOjoUO','classList','22317640hxyzaV','getItem','send_btn','push','scrollHeight','remove_history','全ての履歴を削除します。\x0a本当に削除しますか？','<p><span\x20class=\x22answer\x22>A</span></p><article></article>','time','reload','必ずopen\x20aiのkeyを入力してください\x0aAPI\x20Keyが見つからないので使用できません'];_0x3276=function(){return _0x2352eb;};return _0x3276();}function moldLog(_0xda205a){const _0x4b3b22=_0x23bf75,_0x3c2dfa=[];let _0x1c80cc=[],_0x1ba0db='',_0x72c244='',_0x56df7f=0x0;return _0xda205a[_0x4b3b22(0xfd)](_0x4cc731=>{const _0x429736=_0x4b3b22;return _0x4cc731['role']==_0x429736(0x114)?(_0x56df7f++,_0x72c244!=''&&_0x1c80cc['push'](_0x72c244),_0x72c244='',_0x1ba0db+=_0x4cc731[_0x429736(0xdf)],![]):(_0x1ba0db!=''&&_0x1c80cc[_0x429736(0x14d)](_0x1ba0db),_0x1ba0db='',_0x72c244+=_0x4cc731[_0x429736(0xdf)],![]);}),_0x1c80cc['push'](_0x72c244),_0x1c80cc;}async function download(){const _0x2ddc7b=_0x23bf75,_0x3e4ead=_0x2ddc7b(0x12a)+getNowTime()[_0x2ddc7b(0x117)](/\/|:/g,'')[_0x2ddc7b(0x117)](/ /,'_')+_0x2ddc7b(0x11c);if(!localStorage['getItem']('histories'))return;const _0x23b180=await localStorage[_0x2ddc7b(0x14b)](_0x2ddc7b(0x131)),_0x2f9007=JSON[_0x2ddc7b(0x135)](_0x23b180),_0x3541a0=[];_0x2f9007['forEach'](_0x541a8d=>{const _0x3dcc33=_0x2ddc7b,_0x210081=moldLog(_0x541a8d[_0x3dcc33(0xe0)]),_0x2682e2=_0x3dcc33(0x125)+_0x541a8d[_0x3dcc33(0x140)]+'\x20'+_0x541a8d[_0x3dcc33(0xdc)];_0x3541a0[_0x3dcc33(0x14d)](_0x2682e2),_0x3541a0[_0x3dcc33(0x14d)](_0x210081[_0x3dcc33(0x119)]('\x0a')),_0x3541a0[_0x3dcc33(0x14d)]('');});const _0x2cf6d5=_0x3541a0[_0x2ddc7b(0x119)]('\x0a'),_0x14bd07=new Blob([_0x2cf6d5],{'type':_0x2ddc7b(0x137)}),_0x5b63ad=document[_0x2ddc7b(0x128)]('a');_0x5b63ad[_0x2ddc7b(0xee)]=URL['createObjectURL'](_0x14bd07),_0x5b63ad['download']=_0x3e4ead,_0x5b63ad[_0x2ddc7b(0xf3)]();}function removeHistory(){const _0xd8807=_0x23bf75;if(!localStorage[_0xd8807(0x14b)](_0xd8807(0x131)))return;const _0x374b53=window['confirm'](_0xd8807(0x150));if(!_0x374b53)return;localStorage[_0xd8807(0x14b)](_0xd8807(0x131))&&(localStorage['removeItem']('histories'),location[_0xd8807(0xdd)]());}function newQuestion(){const _0x7670dc=_0x23bf75;document[_0x7670dc(0x112)]('warning')&&document['getElementById'](_0x7670dc(0x127))[_0x7670dc(0x13b)](),document[_0x7670dc(0x126)](_0x7670dc(0x10e))['forEach'](_0x4647e6=>{_0x4647e6['remove']();}),messageHistory=[],promptTime=![];}function switchHistory(){const _0x430c38=_0x23bf75;document['getElementById'](_0x430c38(0x127))&&document[_0x430c38(0x112)](_0x430c38(0x127))[_0x430c38(0x13b)]();const _0x5d82a4=document[_0x430c38(0x112)](_0x430c38(0x111));document['querySelectorAll'](_0x430c38(0x10e))[_0x430c38(0xfd)](_0x43eee5=>{const _0x1e4039=_0x430c38;_0x43eee5[_0x1e4039(0x13b)]();});const _0x13c894=moldLog(messageHistory);_0x13c894[_0x430c38(0xfd)]((_0x28e40f,_0x1bb7ba)=>{const _0x19270b=_0x430c38;let _0x7c7162='';_0x1bb7ba%0x2==0x0?_0x7c7162=_0x19270b(0xe9):_0x7c7162=_0x19270b(0x13f);let _0x3e3917=document[_0x19270b(0x128)]('li');_0x7c7162+=_0x19270b(0x139)+marked[_0x19270b(0x135)](_0x28e40f)+_0x19270b(0xf8),_0x3e3917[_0x19270b(0x13c)]=_0x7c7162,_0x5d82a4[_0x19270b(0x138)](_0x3e3917);});}function htmlspecialchars(_0x5a261f){const _0x188f02=_0x23bf75;if(typeof _0x5a261f!==_0x188f02(0xfc))return _0x5a261f;return _0x5a261f[_0x188f02(0x117)](/[&'`"<>]/g,function(_0x484aab){const _0x3f2398=_0x188f02;return{'&':_0x3f2398(0x104),'\x27':_0x3f2398(0x145),'`':_0x3f2398(0xe1),'\x22':_0x3f2398(0x13a),'<':_0x3f2398(0x141),'>':_0x3f2398(0xe7)}[_0x484aab];});}function getNowTime(){const _0x21a196=_0x23bf75,_0x170cdf=new Date();return _0x170cdf['getFullYear']()+'/'+('0'+(_0x170cdf['getMonth']()+0x1))[_0x21a196(0xf6)](-0x2)+'/'+('0'+_0x170cdf['getDate']())[_0x21a196(0xf6)](-0x2)+'\x20'+('0'+_0x170cdf[_0x21a196(0x10c)]())[_0x21a196(0xf6)](-0x2)+':'+('0'+_0x170cdf[_0x21a196(0xe3)]())['slice'](-0x2)+':'+('0'+_0x170cdf[_0x21a196(0xed)]())['slice'](-0x2);}function textAreaSize(){const _0x2680ef=_0x23bf75;textarea[_0x2680ef(0x12e)][_0x2680ef(0x108)]=clientHeight+'px';let _0x3db3f0=textarea[_0x2680ef(0x14e)];if(_0x3db3f0>formMax){textarea['style']['height']=formMax+'px';return;}textarea[_0x2680ef(0x12e)][_0x2680ef(0x108)]=_0x3db3f0+'px';}function checkKey(_0x4d3fa2=![]){const _0x379268=_0x23bf75,_0x4e6221=document['getElementById']('api_key');if(!localStorage[_0x379268(0x14b)]('myKey')&&_0x4e6221[_0x379268(0xe4)]==='')return _0x4d3fa2&&alert(_0x379268(0xde)),![];return localStorage[_0x379268(0x14b)](_0x379268(0xe6))&&(_0x4e6221['value']=localStorage['getItem']('myKey')),localStorage[_0x379268(0x110)]('myKey',_0x4e6221[_0x379268(0xe4)]),!![];}function saveKey(){const _0x7605=_0x23bf75,_0x2d8e22=document[_0x7605(0x112)](_0x7605(0xf9));if(_0x2d8e22['value']==='')return![];return localStorage[_0x7605(0x110)](_0x7605(0xe6),_0x2d8e22[_0x7605(0xe4)]),![];}function showHistory(){const _0x3ee8c1=_0x23bf75;console[_0x3ee8c1(0x143)](messageHistory);}function getHistory(){const _0x28c782=_0x23bf75;if(!localStorage[_0x28c782(0x14b)](_0x28c782(0x131)))return![];const _0x4854a0=localStorage[_0x28c782(0x14b)](_0x28c782(0x131));logHistory=JSON[_0x28c782(0x135)](_0x4854a0);const _0x4e410c=document[_0x28c782(0x112)](_0x28c782(0x129));logHistory[_0x28c782(0x10a)]()[_0x28c782(0xfd)](_0x15bd4c=>{const _0x3c4460=_0x28c782;let _0x421de2=document[_0x3c4460(0x128)]('li'),_0x2afcb8=document[_0x3c4460(0x128)]('p'),_0x1071e1=document[_0x3c4460(0x128)](_0x3c4460(0xdc));_0x421de2[_0x3c4460(0x149)]['add'](_0x3c4460(0x12b));let _0x3e86fa=_0x15bd4c[_0x3c4460(0x140)],_0x22396b=_0x3e86fa[_0x3c4460(0x121)]('\x0a');_0x22396b[_0x3c4460(0xec)]>0x1&&_0x22396b[0x0]!=''&&(_0x3e86fa=_0x22396b[0x0]),_0x2afcb8['innerText']=_0x3e86fa,_0x421de2['appendChild'](_0x2afcb8),_0x1071e1[_0x3c4460(0x144)]=_0x15bd4c[_0x3c4460(0xdc)],_0x421de2[_0x3c4460(0x138)](_0x1071e1),_0x421de2[_0x3c4460(0xe2)](_0x3c4460(0xdc),_0x15bd4c[_0x3c4460(0xdc)]),_0x4e410c[_0x3c4460(0x11b)](_0x421de2);});}async function setHistory(){const _0x6a41be=_0x23bf75;let _0x3b73f2,_0x4e48c5,_0x363d4a;!promptTime&&(promptTime=getNowTime());const _0x548760=document['getElementById'](_0x6a41be(0x129));let _0x4af1f0=[];localStorage[_0x6a41be(0x14b)]('histories')&&(_0x4e48c5=localStorage[_0x6a41be(0x14b)](_0x6a41be(0x131)),_0x4af1f0=JSON[_0x6a41be(0x135)](_0x4e48c5),!_0x4af1f0&&(_0x4af1f0=[]));if(_0x548760['firstElementChild']){if(_0x548760['firstElementChild'][_0x6a41be(0xf2)]('time')){if(promptTime==_0x548760[_0x6a41be(0x109)][_0x6a41be(0xf2)](_0x6a41be(0xdc))){_0x3b73f2=htmlspecialchars(messageHistory[0x0]['content']),_0x363d4a={'title':_0x3b73f2,'time':promptTime,'data':messageHistory},_0x4af1f0[0x0]=_0x363d4a,_0x4e48c5=JSON[_0x6a41be(0x11a)](_0x4af1f0,undefined,0x1),localStorage['setItem'](_0x6a41be(0x131),_0x4e48c5);return;}}}let _0x46b1a5=document['createElement']('li'),_0x1d87a5=document[_0x6a41be(0x128)]('p'),_0x5b5d2b=document['createElement']('time');_0x3b73f2=messageHistory[0x0][_0x6a41be(0xdf)];let _0x36754b=_0x3b73f2[_0x6a41be(0x121)]('\x0a');_0x36754b[_0x6a41be(0xec)]>0x1&&_0x36754b[0x0]!=''&&(_0x3b73f2=_0x36754b[0x0]),_0x363d4a={'title':_0x3b73f2,'time':promptTime,'data':messageHistory},_0x4af1f0['length']>0x0?_0x4af1f0['unshift'](_0x363d4a):_0x4af1f0['push'](_0x363d4a),_0x4e48c5=JSON[_0x6a41be(0x11a)](_0x4af1f0,undefined,0x1),localStorage[_0x6a41be(0x110)](_0x6a41be(0x131),_0x4e48c5),_0x1d87a5[_0x6a41be(0x144)]=htmlspecialchars(_0x3b73f2),_0x46b1a5['classList'][_0x6a41be(0x118)]('h_log'),_0x46b1a5[_0x6a41be(0x138)](_0x1d87a5),_0x5b5d2b[_0x6a41be(0x144)]=promptTime,_0x46b1a5['setAttribute'](_0x6a41be(0xdc),promptTime),_0x46b1a5[_0x6a41be(0x138)](_0x5b5d2b),_0x548760[_0x6a41be(0x11b)](_0x46b1a5),_0x46b1a5[_0x6a41be(0x132)]=()=>{clickHistory(_0x46b1a5);};}async function sendPrompt(){const _0x13d0ac=_0x23bf75,_0x4fda53=document[_0x13d0ac(0x112)](_0x13d0ac(0xfa));if(!checkKey(!![]))return;if(_0x4fda53['value']=='')return;if(_0x4fda53[_0x13d0ac(0xe4)]['replace'](/\s+/g,'')=='')return;document[_0x13d0ac(0x112)](_0x13d0ac(0x127))&&document[_0x13d0ac(0x112)](_0x13d0ac(0x127))[_0x13d0ac(0x13b)]();event[_0x13d0ac(0x101)]();const _0x52963e=document[_0x13d0ac(0x112)]('api_key')['value'];messageHistory[_0x13d0ac(0x14d)]({'role':_0x13d0ac(0x114),'content':_0x4fda53[_0x13d0ac(0xe4)]});const _0x176f36=_0x13d0ac(0xf4);checkModel();const _0x597c1a=await fetch(_0x176f36,{'method':_0x13d0ac(0xf7),'headers':{'Content-Type':_0x13d0ac(0xf5),'Authorization':'Bearer\x20'+_0x52963e},'body':JSON[_0x13d0ac(0x11a)]({'model':modelType,'stream':!![],'messages':messageHistory})});if(!_0x597c1a['ok']){console[_0x13d0ac(0x120)](_0x13d0ac(0x12f),await _0x597c1a['text']());return;}const _0x5cfed3=document['getElementById'](_0x13d0ac(0x111));let _0x230a2d=_0x13d0ac(0xe9);_0x230a2d+='<article>'+marked[_0x13d0ac(0x135)](_0x4fda53[_0x13d0ac(0xe4)])+_0x13d0ac(0xf8);let _0x1f651d=document[_0x13d0ac(0x128)]('li');_0x1f651d['innerHTML']=_0x230a2d,_0x5cfed3[_0x13d0ac(0x138)](_0x1f651d),_0x4fda53['value']='',_0x4fda53[_0x13d0ac(0x10d)](),textAreaSize(),_0x5cfed3['scrollTop']=_0x5cfed3[_0x13d0ac(0x14e)];let _0x57c12a=document[_0x13d0ac(0x128)]('li');_0x230a2d=_0x13d0ac(0x151),_0x57c12a[_0x13d0ac(0x13c)]=_0x230a2d,_0x5cfed3[_0x13d0ac(0x138)](_0x57c12a),_0x5cfed3[_0x13d0ac(0x102)]=_0x5cfed3['scrollHeight'];let _0x799b72=document[_0x13d0ac(0x100)](_0x13d0ac(0x11e));const _0x1bdfa6=_0x597c1a[_0x13d0ac(0xe5)]['getReader'](),_0x4a3c70=new TextDecoder();let _0x553a6c='';while(!![]){const {value:_0x360f75,done:_0x3051f6}=await _0x1bdfa6[_0x13d0ac(0x142)]();if(_0x3051f6){let _0x22d5ae=marked[_0x13d0ac(0x135)](_0x799b72[_0x13d0ac(0x144)]);_0x799b72[_0x13d0ac(0x13c)]=_0x22d5ae;break;}_0x553a6c+=_0x4a3c70[_0x13d0ac(0x134)](_0x360f75,{'stream':!![]});while(!![]){const _0x54bf0d=_0x553a6c[_0x13d0ac(0x11d)]('\x0a');if(_0x54bf0d===-0x1)break;const _0x46b9e4=_0x553a6c['slice'](0x0,_0x54bf0d);_0x553a6c=_0x553a6c[_0x13d0ac(0xf6)](_0x54bf0d+0x1);if(_0x46b9e4[_0x13d0ac(0x133)](_0x13d0ac(0xef))){if(_0x46b9e4['includes'](_0x13d0ac(0x12d))){let _0x5c2da9=marked[_0x13d0ac(0x135)](_0x799b72['textContent']);_0x799b72[_0x13d0ac(0x13c)]=_0x5c2da9,_0x5cfed3['scrollTop']=_0x5cfed3[_0x13d0ac(0x14e)],await setHistory();return;}const _0x5a65c9=JSON['parse'](_0x46b9e4[_0x13d0ac(0xf6)](0x5));if(_0x5a65c9['choices']&&_0x5a65c9['choices'][0x0]['delta']&&_0x5a65c9[_0x13d0ac(0xf1)][0x0]['delta'][_0x13d0ac(0xdf)]){const _0x128278=_0x5a65c9[_0x13d0ac(0xf1)][0x0][_0x13d0ac(0x13d)][_0x13d0ac(0xdf)];_0x799b72[_0x13d0ac(0xfb)](''+_0x128278+''),_0x5cfed3[_0x13d0ac(0x102)]=_0x5cfed3[_0x13d0ac(0x14e)],await appendAssistantResponse(_0x128278);}}}}}async function chatSend(_0x13fdcf){const _0x2e800b=_0x23bf75;_0x13fdcf[_0x2e800b(0xea)]===_0x2e800b(0x12c)&&(_0x13fdcf[_0x2e800b(0x116)]||_0x13fdcf[_0x2e800b(0x10b)])&&await sendPrompt();}async function appendAssistantResponse(_0x5de34d){const _0x55982d=_0x23bf75;messageHistory['push']({'role':_0x55982d(0x106),'content':_0x5de34d});}